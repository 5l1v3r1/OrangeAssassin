language: python
sudo: false
os:
  - linux
#  - osx # Travis-CI doesn't work well with OSX + python yet
python:
  - "2.7"
  - "3.4"
  - "3.5"
  - "pypy"
  - "pypy3"
install:
  - pip install -r requirements/base.txt
  - if [[ $TRAVIS_PYTHON_VERSION == 2.* ]]; then pip install -r requirements/python2.txt; fi
  - if [[ $TRAVIS_PYTHON_VERSION == 3.* ]]; then pip install -r requirements/python3.txt; fi
  - if [[ $TRAVIS_PYTHON_VERSION == pypy ]]; then pip install -r requirements/pypy2.txt; fi
  - if [[ $TRAVIS_PYTHON_VERSION == pypy3 ]]; then pip install -r requirements/pypy3.txt; fi
  - pip install -r requirements/tests.txt
  - python setup.py install
  - wget http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz
  - gunzip GeoIP.dat.gz
  - wget http://geolite.maxmind.com/download/geoip/database/GeoIPv6.dat.gz
  - gunzip GeoIPv6.dat.gz
script:
  - "py.test tests/unit/ --cov pad --cov scripts --cov-report term-missing"
  - "py.test tests/functional/"
after_script:
  - pep8 --show-source pad
after_success:
  - coveralls
